#!/usr/bin/env python

# ================================================================================
# =                                    WCOUNT                                    =
# ================================================================================

# Count occurences of a word in a file.

import argparse
import re
import sys
from pathlib import Path


def wcount(word: str, file_path: Path | str, ignore_case: bool = False) -> int:
    file_path = Path(file_path)

    # Validate file exists
    if not file_path.exists():
        raise FileNotFoundError(f"File not found: {file_path}")

    if ignore_case:
        pattern = re.compile(rf"\b{word}\b", re.IGNORECASE)
    else:
        pattern = re.compile(rf"\b{word}\b")

    return len(pattern.findall(file_path.read_text()))


if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="Count occurences of a word in a file")
    parser.add_argument("word", help="Word to search for")
    parser.add_argument("file_path", type=Path, help="File to search")
    parser.add_argument(
        "-i",
        "--ignore-case",
        action="store_true",
        help="Ignore case when matching",
    )
    args = parser.parse_args()

    try:
        count = wcount(args.word, args.file_path, args.ignore_case)
        print(f"Found {count} instances of '{args.word}'")
    except FileNotFoundError as e:
        print(f"Error: {e}")
        sys.exit(1)
    except Exception as e:
        print(f"Error: {e}")
        sys.exit(1)
